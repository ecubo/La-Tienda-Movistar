function initialize(o){function t(){navigator.notification.confirm("No ha sido posible acceder a tu ubicación. Desde Ajustes puedes permitir acceder a tu ubicación mientras se utiliza la aplicación.",e,"La Tienda Movistar",["Ver Tiendas","Cancelar"])}function e(t){if(1==t){latitude=40.310192,longitude=-3.684277;var e=new google.maps.LatLng(latitude,longitude);o=2e6,setZoom=5,setGeo=!1,n(e)}else mapaMostrado=!1,$("#mapa").removeClass("active")}function a(o){latitude=o.coords.latitude,longitude=o.coords.longitude;var t=new google.maps.LatLng(latitude,longitude);n(t)}function n(){{var t=o,e=new google.maps.LatLng(latitude,longitude);new google.maps.Circle({center:e,radius:t}).getBounds()}mapOptions={center:e,zoom:setZoom,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1};var a=new google.maps.Map(document.getElementById("map-canvas"),mapOptions);if(setGeo){var n=new google.maps.LatLng(latitude,longitude);new google.maps.Marker({position:n,map:a,icon:"cdvfile://localhost/persistent/contents/sections/mapa/here.svg"})}marcadores=[];var r=["autonomo","reparacion","autonRep","generico"];setMarkers(e,t,a),i=new MarkerClusterer(a,marcadores,{minimumClusterSize:2,styles:[{url:"cdvfile://localhost/persistent/contents/sections/mapa/movistar35.svg",height:35,width:35,textColor:"rgb(0,92,132)",textSize:16,anchor:[35,35]},{url:"cdvfile://localhost/persistent/contents/sections/mapa/movistar45.svg",height:45,width:45,textColor:"rgb(0,92,132)",textSize:16,anchor:[45,45]},{url:"cdvfile://localhost/persistent/contents/sections/mapa/movistar55.svg",height:55,width:55,textColor:"rgb(0,92,132)",textSize:16,anchor:[55,55]}]}),$("#autonomos").on("click",function(o){o.preventDefault(),o.stopPropagation(),$("input.control.autonomo").attr("checked",!$("input.control.autonomo").attr("checked")),$(this).find("a").toggleClass("active"),"checked"==$("input.control.todos").attr("checked")?($("input.control.todos").attr("checked",!1),r=["autonomo","autonRep"]):"checked"==$("input.control.autonomo").attr("checked")&&"checked"==$("input.control.reparacion").attr("checked")?($("input.control.todos").attr("checked",!1),r=["autonRep"]):"checked"!=$("input.control.autonomo").attr("checked")&&"checked"==$("input.control.reparacion").attr("checked")?($("input.control.todos").attr("checked",!1),r=["autonRep","reparacion"]):($("input.control.todos").attr("checked","checked"),r=["autonomo","reparacion","autonRep","generico"]),c()}),$("#reparacion").on("click",function(o){o.preventDefault(),o.stopPropagation(),$("input.control.reparacion").attr("checked",!$("input.control.reparacion").attr("checked")),$(this).find("a").toggleClass("active"),"checked"==$("input.control.todos").attr("checked")?($("input.control.todos").attr("checked",!1),r=["reparacion","autonRep"]):"checked"==$("input.control.reparacion").attr("checked")&&"checked"==$("input.control.autonomo").attr("checked")?($("input.control.todos").attr("checked",!1),r=["autonRep"]):"checked"!=$("input.control.reparacion").attr("checked")&&"checked"==$("input.control.autonomo").attr("checked")?($("input.control.todos").attr("checked",!1),r=["autonRep","autonomo"]):($("input.control.todos").attr("checked","checked"),r=["autonomo","reparacion","autonRep","generico"]),c()}),$("#mapa .headerLocation").on("click","a",function(o){return o.preventDefault(),o.stopPropagation(),$("#mapa, #autonomos a, #reparacion a").removeClass("active"),$("input.control.todos").attr("checked",!0),$("input.control.autonomo").attr("checked",!1),$("input.control.reparacion").attr("checked",!1),r=["autonomo","reparacion","autonRep","generico"],c(),!1});var c=function(){for(var o=0,t=marcadores.length;t>o;o++)marcadores[o].setVisible(-1!==r.indexOf(marcadores[o].tipo));i.setIgnoreHidden(!0),i.repaint()}}var i;navigator.geolocation.getCurrentPosition(a,t)}function setMarkers(o,t,e){function a(o,t,e){!function(t,e){google.maps.event.addListener(t,"click",function(){function a(o){return 1!=o?!1:void(window.location.href="tel:"+e.tel)}function n(o){var t,e,a="";for(t=o.split(" "),e=t.length,c=0;e>c;c++)c!=e-1?a=a+i(t[c])+" ":a+=i(t[c]);return a}function i(o){return o.substr(0,1).toUpperCase()+o.substr(1,o.length).toLowerCase()}o.panTo(t.getPosition()),navigator.notification.confirm(n(e.calle.toLowerCase())+" "+n(e.pobl.toLowerCase()),a,e.name,["Teléfono","OK"])})}(t,e)}for(var n=function(){var o=null;return $.ajax({async:!1,global:!1,url:"cdvfile://localhost/persistent/contents/sections/mapa/json/tiendas.json",dataType:"json",success:function(t){o=t}}),o}(),i=new google.maps.Circle({strokeColor:"#000000",strokeOpacity:0,strokeWeight:1,fillColor:"rgb(0,92,132)",fillOpacity:.2,clickable:!1,map:e,center:o,radius:t}),r=i.getBounds(),c=0,s=n.length;s>c;c++){var l=n[c],p=new google.maps.LatLng(l.lat,l.lon);if(r.contains(p)){if(l.reparacion&&l.autonomo)var u=new google.maps.Marker({position:p,map:e,title:l.name,phone:l.tel,icon:"cdvfile://localhost/persistent/contents/sections/mapa/movistar.svg",tipo:"autonRep"});else if(l.reparacion)var u=new google.maps.Marker({position:p,map:e,title:l.name,phone:l.tel,icon:"cdvfile://localhost/persistent/contents/sections/mapa/movistar.svg",tipo:"reparacion"});else if(l.autonomo)var u=new google.maps.Marker({position:p,map:e,title:l.name,phone:l.tel,icon:"cdvfile://localhost/persistent/contents/sections/mapa/movistar.svg",tipo:"autonomo"});else var u=new google.maps.Marker({position:p,map:e,title:l.name,phone:l.tel,icon:"cdvfile://localhost/persistent/contents/sections/mapa/movistar.svg",tipo:"generico"});a(e,u,l),marcadores.push(u)}}}var mapaMostrado=!1,setZoom=13,latitude,longitude,setGeo=!0;$("#sumario ul li.location").on("click","a",function(o){function t(){}return o.preventDefault(),o.stopPropagation(),navigator.onLine?($("#mapa").addClass("active"),mapaMostrado||(mapaMostrado=!mapaMostrado,initialize(3e3))):navigator.notification.alert("Para localizar tu tienda Movistar más cercana necesitas disponer de conexión a internet.",t,"La Tienda Movistar","OK"),!1});